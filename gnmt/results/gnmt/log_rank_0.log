2021-10-17 09:53:31 - INFO - 0 - Saving results to: results/gnmt
2021-10-17 09:53:31 - INFO - 0 - Run arguments: Namespace(Gpipe=False, batching='bucketing', beam_size=5, cov_penalty_factor=0.1, cuda=True, cudnn=True, dataset_dir='/gf3/home/xyye/wmt16_de_en', decay_factor=0.5, decay_interval=None, decay_steps=4, dropout=0.2, env=False, epochs=8, eval=True, grad_clip=5.0, hidden_size=1024, intra_epoch_eval=0, keep_checkpoints=0, len_norm_const=5.0, len_norm_factor=0.6, local_rank=0, lr=0.001, math='fp32', max_length_test=150, max_length_train=50, max_length_val=125, max_size=None, min_length_test=0, min_length_train=0, min_length_val=0, num_buckets=5, num_layers=8, num_split=4, optimizer='Adam', optimizer_extra='{}', partition=4, print_freq=10, rank=0, remain_steps=0.666, results_dir='results', resume=None, save='gnmt', save_all=False, save_freq=5000, save_path='results/gnmt', seed=None, shard_size=80, share_embedding=True, smoothing=0.1, start_epoch=0, target_bleu=24.0, test_batch_size=16, test_loader_workers=0, train_batch_size=128, train_global_batch_size=None, train_iter_size=1, train_loader_workers=2, train_num=4, val_batch_size=16, val_loader_workers=0, warmup_steps=200)
2021-10-17 09:53:31 - INFO - 0 - Using random master seed: 1878360146
2021-10-17 09:53:31 - INFO - 0 - Worker 0 is using worker seed: 3348590967
2021-10-17 09:53:31 - INFO - 0 - Building vocabulary from /gf3/home/xyye/wmt16_de_en/vocab.bpe.32000
2021-10-17 09:53:32 - INFO - 0 - Size of vocabulary: 32317
2021-10-17 09:53:32 - INFO - 0 - Processing data from /gf3/home/xyye/wmt16_de_en/train.tok.clean.bpe.32000.en
2021-10-17 09:53:34 - INFO - 0 - Processing data from /gf3/home/xyye/wmt16_de_en/train.tok.clean.bpe.32000.de
2021-10-17 09:53:36 - INFO - 0 - Filtering data, min len: 0, max len: 50
2021-10-17 09:53:43 - INFO - 0 - Pairs before: 4068191, after: 3498161
2021-10-17 09:53:44 - INFO - 0 - Processing data from /gf3/home/xyye/wmt16_de_en/newstest_dev.tok.clean.bpe.32000.en
2021-10-17 09:53:44 - INFO - 0 - Processing data from /gf3/home/xyye/wmt16_de_en/newstest_dev.tok.clean.bpe.32000.de
2021-10-17 09:53:44 - INFO - 0 - Filtering data, min len: 0, max len: 125
2021-10-17 09:53:44 - INFO - 0 - Pairs before: 5100, after: 5100
2021-10-17 09:53:44 - INFO - 0 - Processing data from /gf3/home/xyye/wmt16_de_en/newstest2014.tok.bpe.32000.en
2021-10-17 09:53:44 - INFO - 0 - Filtering data, min len: 0, max len: 150
2021-10-17 09:53:44 - INFO - 0 - Pairs before: 3003, after: 3003
2021-10-17 09:53:46 - INFO - 0 - Sequential(
  (Emb1): embed1(
    (embed): Embedding(32320, 1024, padding_idx=0)
    (dropout): Dropout(p=0.2, inplace=False)
  )
  (E_lstm1): lstm1(
    (layer): LSTM(1024, 1024, bidirectional=True)
  )
  (Dropout1): dropout1(
    (dropout): Dropout(p=0.2, inplace=False)
  )
  (E_lstm2): lstm1(
    (layer): LSTM(2048, 1024)
  )
  (Dropout2): dropout1(
    (dropout): Dropout(p=0.2, inplace=False)
  )
  (E_lstm3): lstm1(
    (layer): LSTM(1024, 1024)
  )
  (Dropout3): dropout1(
    (dropout): Dropout(p=0.2, inplace=False)
  )
  (E_lstm4): lstm1(
    (layer): LSTM(1024, 1024)
  )
)
2021-10-17 09:53:46 - INFO - 0 - Training optimizer config: {'optimizer': 'Adam', 'lr': 0.001}
2021-10-17 09:53:46 - INFO - 0 - Training LR schedule config: {'warmup_steps': 200, 'remain_steps': 0.666, 'decay_interval': None, 'decay_steps': 4, 'decay_factor': 0.5}
2021-10-17 09:53:46 - INFO - 0 - Number of stage0 parameters: 79273984
2021-10-17 09:53:51 - INFO - 0 - Using optimizer: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.001
    weight_decay: 0
)
2021-10-17 09:53:51 - INFO - 0 - Scheduler warmup steps: 200
2021-10-17 09:53:51 - INFO - 0 - Scheduler remain steps: 9078
2021-10-17 09:53:51 - INFO - 0 - Scheduler decay interval: 1138
2021-10-17 09:53:51 - INFO - 0 - Scheduler decay factor: 0.5
2021-10-17 09:53:51 - INFO - 0 - Scheduler max decay steps: 4
2021-10-17 09:53:51 - INFO - 0 - Starting epoch 0
2021-10-17 09:53:53 - INFO - 0 - Sampler for epoch 0 uses seed 3210064540
2021-10-17 09:53:54 - INFO - 0 - TRAIN [0][0/1704]	Time 1.622 (0.000)	Data 5.57e-01 (0.00e+00)	Tok/s 19563 (0)	LR 1.023e-05
2021-10-17 09:54:01 - INFO - 0 - TRAIN [0][10/1704]	Time 0.584 (0.741)	Data 5.12e-04 (3.86e-04)	Tok/s 38816 (37850)	LR 1.288e-05
2021-10-17 09:54:08 - INFO - 0 - TRAIN [0][20/1704]	Time 0.587 (0.707)	Data 3.20e-04 (3.68e-04)	Tok/s 38788 (37614)	LR 1.622e-05
2021-10-17 09:54:15 - INFO - 0 - TRAIN [0][30/1704]	Time 0.657 (0.706)	Data 3.64e-04 (3.60e-04)	Tok/s 34488 (37206)	LR 2.042e-05
2021-10-17 09:54:22 - INFO - 0 - TRAIN [0][40/1704]	Time 0.753 (0.690)	Data 3.45e-04 (3.58e-04)	Tok/s 42269 (37370)	LR 2.570e-05
2021-10-17 09:54:28 - INFO - 0 - TRAIN [0][50/1704]	Time 0.760 (0.679)	Data 3.40e-04 (3.54e-04)	Tok/s 41965 (37288)	LR 3.236e-05
2021-10-17 09:54:35 - INFO - 0 - TRAIN [0][60/1704]	Time 0.771 (0.681)	Data 3.61e-04 (3.54e-04)	Tok/s 40984 (37262)	LR 4.074e-05
2021-10-17 09:54:42 - INFO - 0 - TRAIN [0][70/1704]	Time 0.759 (0.679)	Data 3.32e-04 (3.54e-04)	Tok/s 41636 (37067)	LR 5.129e-05
2021-10-17 09:54:48 - INFO - 0 - TRAIN [0][80/1704]	Time 0.617 (0.680)	Data 3.26e-04 (3.52e-04)	Tok/s 36979 (37109)	LR 6.457e-05
